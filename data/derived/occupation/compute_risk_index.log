
  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   15.1   Copyright 1985-2017 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 2-core Stata perpetual license:
       Serial number:  501506203290
         Licensed to:  Miklos Koren
                       CEU MicroData


Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do compute_risk_index.do 

. clear

. import delimited "../../clean/onet/risks.csv", case(preserve) varnames(1)
(19 vars, 764 obs)

. 
. **************
. *generating summery indexes: communication and infection measures
. *************
. 
. * within-firm group interaction
. rename group group1

. egen group = rowmean(group1 consult interpersonal)

. * customer communication
. egen customer = rowmean(contact customers public care coach interpersonal)

. * are these contacts face to face? This is a multiplier because if F2F=0, the
> n none of the above is relevant
. foreach X of var group customer {
  2.         replace `X' = round(`X' * face2face / 100)
  3. }
(753 real changes made, 1 to missing)
(759 real changes made, 1 to missing)

. 
. * require physical presence in close proximity to others
. egen presence = rowmean(infections move control operate repair* inspect)

. * Does this require proximity to others? Otherwise not subject to social dist
> ancing 
. replace presence = round(presence * proximity / 100)
(764 real changes made, 1 to missing)

. 
. label variable group "Group communication index [0,100]"

. label variable customer "Customer communication index [0,100]"

. label variable presence "Physical presence index [0,100]"

. 
. keep SOCCode Description group customer presence

. compress
  variable group was float now byte
  variable customer was float now byte
  variable presence was float now byte
  (6,876 bytes saved)

. 
. save "risks.dta", replace
file risks.dta saved

. 
end of do-file
